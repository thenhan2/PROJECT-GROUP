# FakeNet-NG Configuration File
# Advanced HTTP/HTTPS Service Simulation for Malware Analysis Lab
# 
# Reference: https://github.com/countercept/fakenet-ng
# Created: Feb 2026 - Integrated Malware Analysis Lab

###############################################################################
# GENERAL CONFIGURATION
###############################################################################

[General]

# Log directory
LogDir = /var/log/fakenet-ng

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LogLevel = DEBUG

# PID file
PIDFile = /var/run/fakenet-ng.pid

# Verbose output
Verbose = True

# Divert HTTPS to HTTP (redirect HTTPS to HTTP for interception)
DivertHTTPS = True

###############################################################################
# NETWORK CONFIGURATION
###############################################################################

[Network]

# Network interfaces to listen on
# Leave empty to listen on all interfaces
# Interface =

# DNS server to use for external lookups (INetSim)
DNSServer = 172.21.0.2

# Default route gateway
Gateway = 172.21.0.1

# Enable traffic redirection
TrafficRedirection = True

# Traffic redirection mode: iptables, pf (pfctl), or windivert
RedirectionMode = iptables

###############################################################################
# HTTP LISTENER CONFIGURATION
###############################################################################

[HTTPListener]

# HTTP Listener port
Port = 80

# Alternative HTTP ports to listen on
AlternativePorts = 8000, 8080, 8888, 9000

# HTTP version string to advertise
HTTPVersion = HTTP/1.1

# Server string
ServerString = Microsoft-IIS/10.0

# Default response on root path
DefaultResponse = <html><body>IIS Server</body></html>

# Enable HTTP logging
LogTraffic = True

# Log request/response details
LogDetail = True

###############################################################################
# HTTPS LISTENER CONFIGURATION
###############################################################################

[HTTPSListener]

# HTTPS Listener port
Port = 443

# Alternative HTTPS ports
AlternativePorts = 8443

# SSL/TLS version
SSLVersion = TLSv1.2

# Certificate file
CertificateFile = /opt/fakenet-ng/certs/server.pem

# Private key file
KeyFile = /opt/fakenet-ng/certs/server.key

# Enable HTTPS logging
LogTraffic = True

# Log request/response details
LogDetail = True

###############################################################################
# DNS LISTENER CONFIGURATION (OPTIONAL)
###############################################################################
# Note: INetSim xử lý DNS chính, FakeNet-NG có thể xử lý DNS thứ cấp

[DNSListener]

# Enable DNS listener
Enabled = False

# DNS Listener port
Port = 5353

# Log DNS queries
LogTraffic = True

###############################################################################
# RESPONSE HANDLERS
###############################################################################

[ResponseHandlers]

# Type: static | dynamic | redirect | proxy

# Static HTML response for all HTTP requests
HandlerType = static
StaticContent = <html><h1>FakeNet-NG Web Server</h1><p>This is a fake web server for malware analysis.</p></html>

# Additional response handlers for specific patterns
# [Handler:ajax]
# Pattern = .*\.ajax.*
# Type = static
# Content = {}

# [Handler:json]
# Pattern = .*\.json.*
# Type = static
# Content = {"status": "success"}

# [Handler:exe]
# Pattern = .*\.(exe|dll|sys).*
# Type = static
# Content-Type = application/octet-stream
# Content = [MZ binary content would go here]

###############################################################################
# PROXYING CONFIGURATION (Optional)
###############################################################################
# Để forward traffic tới external server nếu cần

[Proxy]

# Enable proxy mode
Enabled = False

# Upstream proxy server
# ProxyServer = 172.21.0.2:80

# HTTPS forwarding
# HTTPSProxy = 172.21.0.2:443

###############################################################################
# LOGGING AND MONITORING
###############################################################################

[Logging]

# Log file path
LogFile = /var/log/fakenet-ng/fakenet-ng.log

# Traffic log file
TrafficLogFile = /var/log/fakenet-ng/traffic.log

# Request/Response log file (detailed)
DetailLogFile = /var/log/fakenet-ng/detail.log

# Archive old logs
ArchiveOldLogs = True

# Maximum log file size (MB)
MaxLogSize = 100

# Maximum number of archived log files
MaxArchives = 10

###############################################################################
# SECURITY CONFIGURATION
###############################################################################

[Security]

# Maximum connections
MaxConnections = 1000

# Connection timeout (seconds)
ConnectionTimeout = 60

# Request timeout (seconds)
RequestTimeout = 30

# Enable rate limiting
RateLimiting = False

# Max requests per minute per IP
RateLimitPerMinute = 1000

###############################################################################
# ADVANCED OPTIONS
###############################################################################

[Advanced]

# Enable HTP (INetSim-like) compatibility mode
HTPCompatibility = True

# Forward traffic to INetSim for unknown services
ForwardToINetSim = True
INetSimIP = 172.21.0.2
INetSimPort = 80

# Enable packet capture for analysis
PacketCapture = True
PacketCaptureFile = /var/log/fakenet-ng/traffic.pcap

# Buffer size for socket operations
SocketBufferSize = 4096

# TCP backlog
TCPBacklog = 128

###############################################################################
# INTEGRATION WITH OTHER TOOLS
###############################################################################

# Syslog server (for alerting)
# SyslogServer = 127.0.0.1
# SyslogPort = 514
# SyslogFacility = local0

# Elasticsearch (for centralized logging) - Optional
# ElasticsearchURL = http://elasticsearch:9200
# ElasticsearchIndex = fakenet-ng-%Y.%m.%d

###############################################################################
# NOTES FOR MALWARE ANALYSIS
###############################################################################
# 1. FakeNet-NG intercepts HTTP/HTTPS traffic
# 2. All requests are logged for analysis
# 3. Static responses prevent actual external communications
# 4. SSL/TLS interception requires custom certificate installation
# 5. Logs can be forwarded to SIEM for correlation with other data
# 6. Integration with INetSim allows graceful failover for unknown services
